FROM debian:stable-slim
LABEL maintainer="LaChenilleBarbue"

RUN apt-get update && \
    apt-get install -y openjdk-11-jdk zip wget && \
    wget https://dl.google.com/android/repository/commandlinetools-linux-8092744_latest.zip && \
    mv commandlinetools-linux-8092744_latest.zip tools_latest.zip && \
    mkdir -p /opt/android-sdk/cmdline-tools/ && \
    unzip tools_latest.zip -d /opt/android-sdk/cmdline-tools/ && \
    mv /opt/android-sdk/cmdline-tools/cmdline-tools /opt/android-sdk/cmdline-tools/latest

RUN yes | /opt/android-sdk/cmdline-tools/latest/bin/sdkmanager platform-tools emulator && \
    yes | /opt/android-sdk/cmdline-tools/latest/bin/sdkmanager "platforms;android-28" && \
    yes | /opt/android-sdk/cmdline-tools/latest/bin/sdkmanager "system-images;android-28;google_apis;x86" && \
    yes | /opt/android-sdk/cmdline-tools/latest/bin/sdkmanager "build-tools;28.0.3"

RUN apt-get install -y qemu-system-x86

RUN /opt/android-sdk/cmdline-tools/latest/bin/avdmanager --verbose create avd --force --name "pixel_4.4" --device "pixel" --package "system-images;android-28;google_apis;x86" --tag "google_apis" --abi "x86"

#more options -> https://developer.android.com/studio/run/emulator-commandline
CMD ["/opt/android-sdk/emulator/emulator","-avd","pixel_4.4"]

#docker run --network host --device /dev/kvm --rm -v /tmp/.X11-unix:/tmp/.X11-unix -e DISPLAY=$DISPLAY -v $HOME/.Xauthority:/root/.Xauthority <image_name>
